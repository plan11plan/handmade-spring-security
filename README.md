# phase-0
## 📋App 기능 요구사항
### ✅ 구현 완료 조건
- [x] 유저를 생성하고 비밀번호를 암호화하여 저장한다.
- [x] 저장된 유저의 비밀번호를 검증한다.
### 📌 유저
- [x] 유저를 생성한다.
  - 빈 유저이름 -> 예외
  - 빈 패스워드 -> 예외
  - 빈 역할 -> 예외

### 📌 비밀번호
- [x] 비밀번호를 암호화한다.
  - 같은 비밀번호라도 -> 매번 다른 해시 생성
- [x] 비밀번호를 검증한다.
  - 올바른 비밀번호 -> true
  - 잘못된 비밀번호 -> false

---
# Authentication 아키텍처 구현하기
## 📋phase-1-Authentication 모델 기능 요구사항

## 1️⃣ 인증 모델 구현하기
###  ✅ 구현 완료 조건
- [x] 권한을 표현하고 비교한다.
- [x] User를 인증 시스템에서 사용할 형태로 변환한다.
- [x] 인증 전후 상태를 표현한다.
- [x] 인증 정보를 저장하고 전역에서 접근한다.

### 📌 권한 관리
- [x] 권한을 표현한다.
  - "ROLE_USER" 같은 권한 문자열 저장
  - 빈 권한 -> 예외
- [x] 권한을 비교한다.
  - 같은 권한끼리 비교 -> 동일하다고 판단
  - 다른 권한끼리 비교 -> 다르다고 판단

### 📌 사용자 상세 정보
- [x] User를 인증 시스템에서 사용할 형태로 변환한다.
  - 유효한 User -> 변환 성공
  - null User -> 예외
- [x] 사용자의 인증 정보를 제공한다.
  - 사용자 이름 조회 가능
  - 권한 목록 조회 가능
- [x] 계정 상태를 제공한다.

### 📌 사용자 정보 조회
- [x] 사용자 이름으로 사용자 정보를 조회한다.
  - 존재하는 사용자 이름 -> 사용자 상세 정보 반환
  - 존재하지 않는 사용자 이름 -> 예외
  - null 사용자 이름 -> 예외

### 📌 인증 정보 관리
- [x] JWT 인증 정보를 표현한다.
  - userId로 사용자 식별
  - 권한 목록 포함
  - 인증 상태 = 참 (JWT는 이미 검증됨)
  - null userId -> 예외
  - null authorities -> 예외
- [x] 사용자 식별자를 제공한다.
  - userId 조회 가능
  - Long 타입 반환
- [x] 권한 목록을 제공한다.
  - authorities 조회 가능
  - 여러 권한 포함 가능
- [x] credentials는 null을 반환한다.
  - JWT에서는 비밀번호 불필요

### 📌 보안 컨텍스트 관리
- [x] 인증 정보를 저장한다.
- [x] 저장된 인증 정보 조회 가능
  - 비어있으면 -> null
- [x] 인증 정보를 삭제한다.
  - 인증 정보 삭제 -> 삭제 성공
  - 삭제 후 조회 -> null
- [x] Authentication이 같으면 같은 보안 컨텍스트다.
  - Authentication 같다 -> equeals true
  - Authentication 다르다 -> equals false

### 📌 전역 보안 컨텍스트 접근
- [x] 스레드별로 보안 컨텍스트를 관리한다.
  - 현재 스레드에 보안 컨텍스트 저장
  - null 컨텍스트 저장 -> 예외
  - 현재 스레드에서 보안 컨텍스트 조회
  - 다른 스레드에서 조회 -> 새로운 빈 컨텍스트
  - 컨텍스트가 없으면 -> 새로운 빈 컨텍스트 생성
  - 초기화 후 조회 -> 새로운 빈 컨텍스트
  - 보안 컨텍스트를 초기화한다.
  - 스레드별로 독립적인 컨텍스트 관리
  - 빈 컨텍스트 생성하기

---

## 📋phase-2-Authentication 아키텍처 기능 요구사항

## 2️⃣ 인증 아키텍처 구현하기
###  ✅ 구현 완료 조건
- [x] 인증 요청을 처리한다.
- [x] 여러 인증 방식을 지원한다.
- [x] 인증 실패 응답을 생성한다.
- [x] HTTP 요청에서 인증을 수행한다.
- [x] 인증 컴포넌트를 등록한다.
- [x] 필터를 서블릿에 등록한다.
- [x] 전체 인증 흐름을 검증한다.

### 📌 특정 인증 수행 (AuthenticationProvider 구현체)
- [x] 인증 객체의 인증정보를 검증한다.
    - 인증 후 원본 객체 반환한다.
    - 존재하지 않은 사용자 -> 예외
    - 인증이 잘 끝나고 인증 상태가 true
- [x] 인증할 수 있는지 알려준다.
    - 가능하면 -> true
    - 안되면 ->false

### 📌 여러 인증 구현체를 관리하고 인증 위임하기 (AuthenticationManager 구현체, ProviderManager)
- [x] Provider 목록을 관리한다.
  - 빈 Provider 목록 -> 예외
  - null Provider 목록 -> 예외
- [x] 지원 가능한 Provider를 찾아 인증을 위임한다.
  - 지원 가능한 Provider 존재 -> 해당 Provider 사용
  - 지원 가능한 Provider 없음 -> 예외

### 📌 인증 실패 응답 (AuthenticationEntryPoint)
- [x] 인증 실패 응답(자격 증명 요청)을 생성한다.
    - 인증 실패 발생 -> HTTP 응답 생성
    - 예외 정보 -> 적절한 상태 코드와 메시지

### 📌 요청 기반 인증 (AbstractAuthenticationProcessingFilter)
- [x] HTTP 요청에서 인증을 시도한다.
    - 인증 필요한 요청 -> 인증 시도
    - 인증 성공 -> 다음 처리로 진행
    - 인증 실패 -> 실패 응답 생성
- [x] 요청에서 인증 정보를 추출한다.
    - HTTP 요청 -> 인증 정보 생성
    - 인증 정보 없음 -> null 반환
- [x] 인증 결과를 처리한다.
    - 인증 성공 -> 보안 컨텍스트에 저장
    - 인증 실패 -> 실패 핸들러 호출

---
# Authorization 아키텍처 구현하기
## 📋phase-3-Authorization 모델 기능 요구사항

## 3️⃣ 권한 모델 구현하기
###  ✅ 구현 완료 조건
- [ ] 권한 결정 결과를 표현한다.
- [ ] 권한 거부 예외를 발생시킨다.

### 📌 권한 결정
- [ ] 권한 결정 결과를 표현한다.
    - 허용 -> true
    - 거부 -> false
- [ ] 결정 결과를 조회한다.
    - 허용 여부 반환

### 📌 권한 거부 예외
- [ ] 권한 거부 시 예외를 발생시킨다.
    - 메시지 포함
    - RuntimeException 상속

---

## 📋phase-4-Authorization 아키텍처 기능 요구사항

## 4️⃣ 권한 아키텍처 구현하기
###  ✅ 구현 완료 조건
